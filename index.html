<!DOCTYPE html>
<html>
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <style> .chart rect { fill: steelblue; }
    #tooltip {
        opacity: 0;
        position: absolute;
        text-align: center;
        width: 60px; height: 40px;
        background: white;
        border: 0px;
    } </style>

    <style> circle {fill: lightblue; stroke: black;}</style>
    <body onload="init()">
        <h1>Hello World</h1>
        <P> I'm hosted with GitHub Pages.</P>
        <svg width=700 height="700">   
        </svg>
        <script>
            async function init() {
                const data = await d3.csv(
                    'https://raw.githubusercontent.com/ssong44/ssong44.github.io/main/Data/data_filtered.csv');
                var x = d3.scaleLog().domain([500, 160000]).range([0, 600]).base(10);
                var y = d3.scaleLinear().domain([50, 85]).range([600, 0]);
                var color = d3.scaleLinear().domain([0, 100]).range(["lightblue","purple"]);
                var pop = d3.scaleLog().domain([100000, 2000000000]).range([2, 30]).base(10);
                var continent = d3.scaleLinear()
                    .domain(["Africa", "North America", "Middle & South America", "Asia", "Europe", "Oceania"])
                    .range(["brown", "green", "orange", "red", "purple", "blue"]);
                
                // Axes
                d3.select("svg").append("g")
                    .attr("transform", "translate("+50+", "+50+")")
                    .call(d3.axisLeft(y)
                    .tickValues([80,75,70,65,60,55,50])
                    .tickFormat(d3.format("~s")));
                d3.select("svg").append("g")
                    .attr("transform", "translate("+50+", "+(600+50)+")")
                    .call(d3.axisBottom(x)
                    .tickValues([1000, 2000, 5000, 10000, 50000, 100000])
                    .tickFormat(d3.format("$,")));

                // Axis Labels
                d3.select("svg").append("text")
                    .attr("class", "x label")
                    .attr("text-anchor", "end")
                    .attr("x", 400)
                    .attr("y", 690)
                    .text("GDP per capita");
                d3.select("svg").append("text")
                    .attr("class", "y label")
                    .attr("text-anchor", "end")
                    .attr("x", -250)
                    .attr("y", 6)
                    .attr("dy", ".75em")
                    .attr("transform", "rotate(-90)")
                    .text("Life Expectancy (year)");

                // Plot
                d3.select('svg')
                    .attr("width", 600 + 2*50)
                    .attr("height", 600 + 2*50)
                    .append("g")
                        .attr("transform", "translate("+50+", "+50+")")
                    .selectAll('circle').data(data).enter()
                        .append("circle")
                        .attr("cx", function(d) { return x(d.GDP); } )
                        .attr("cy", function(d) { return y(d.LifeExpectancy); } )
                        .attr("r", function(d) { return pop(d.Population); } )
                        .style("fill", function(d) { return continent(d.Continent); } );
            }
        </script>
    </body>
</html>